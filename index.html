<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Robot Face</title>
  <style>
    body {
      background-color: black;
      margin: 0;
      overflow: hidden;
    }

    .face {
      position: relative;
      width: 100vw;
      height: 100vh;
    }

    .eye {
      width: 30vw;
      height: 30vw;
      max-width: 200px;
      max-height: 200px;
      background: #00cfff;
      border-radius: 50%;
      box-shadow: 0 0 40px #00cfff, inset 0 0 10px #99efff;
      position: absolute;
      animation: blink 5s infinite;
    }

    .left-eye {
      top: 15%;
      left: 20%;
    }

    .right-eye {
      top: 15%;
      right: 20%;
    }

    .pupil {
      width: 80%;
      height: 80%;
      background: #030000;
      border-radius: 50%;
      position: absolute;
      top: 10%;
      left: 10%;
    }

    @keyframes blink {
      0%, 97%, 100% { transform: scaleY(1); opacity: 1; }
      98%, 99%     { transform: scaleY(0.1); opacity: 0.3; }
    }

    .mouth {
      width: 60vw;
      height: 100px;
      border-bottom: 4px solid #00cfff;
      border-radius: 0 0 50px 50px;
      box-shadow: 0 0 15px #00cfff;
      position: absolute;
      bottom: 15%;
      left: 50%;
      transform: translateX(-50%);
      transition: height 0.1s ease, border-bottom-width 0.1s ease, box-shadow 0.1s ease;
    }
  </style>
</head>
<body>
  <div class="face">
    <div class="eye left-eye"><div class="pupil"></div></div>
    <div class="eye right-eye"><div class="pupil"></div></div>
    <div class="mouth"></div>
  </div>

  <script>
    const mouth = document.querySelector('.mouth');

    function simulateTalking() {
      const mouthHeight = 40 + Math.random() * 80;
      const borderWidth = 2 + Math.random() * 8;
      const glow = 10 + (mouthHeight / 120) * 20;

      mouth.style.height = mouthHeight + 'px';
      mouth.style.borderBottomWidth = borderWidth + 'px';
      mouth.style.boxShadow = `0 0 ${glow}px #00cfff`;
    }

    let talking = false;
    let interval = null;

    function startTalking() {
      if (!interval) {
        interval = setInterval(simulateTalking, 100);
      }
    }

    function stopTalking() {
      clearInterval(interval);
      interval = null;
      mouth.style.height = '100px';
      mouth.style.borderBottomWidth = '4px';
      mouth.style.boxShadow = '0 0 15px #00cfff';
    }

    // Every 300ms, check if Raspberry Pi is speaking
    setInterval(() => {
      fetch('http://YOUR_PI_IP_ADDRESS:5000/status')
        .then(res => res.json())
        .then(data => {
          if (data.talking) {
            startTalking();
          } else {
            stopTalking();
          }
        })
        .catch(err => {
          stopTalking();
        });
    }, 300);
  </script>
</body>
</html>
